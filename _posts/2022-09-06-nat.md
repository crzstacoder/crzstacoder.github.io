---
published: true
title: "[CS] NAT와 포트포워딩"
excerpt: "네트워크 기초"

tags:
    - [portfowording, 포트포워딩, 네트워크, NAT]
categories:
    - cs

toc: true
toc_sticky: true

date: 2022-09-06
last_modified_at: 2022-09-06
---
  
**본 내용은 고등학교 3학년 초짜 개발자의 공부노트이므로, 틀린 정보일 수 있습니다.**
## **I. 알아야할 사전지식**

### **I-1) 공인IP**
우리가 사용하는 네트워크에는 무조건적으로 주소가 존재한다.  
그 주소 하나하나를 공인IP (Public IP)라고 한다.

### **I-2) 사설IP**
42억 9천여만 개밖에 사용하지 못하는 공인IP가 부족할 수 있다는 우려가 제기되었다.  
그렇기에 하나의 공인IP 안에서만 사용 가능한 사설IP를 또 만들어 둘 수 있다.  
그 사설 IP의 형식은 192.XXX.XX.XX라던가 172.XXX.XX.XX와 같이 형식이 정해져있다. 
즉, 사설 IP는 다른 네트워크에서는 사용을 하지 못한다는 것이다.  
우리는 무선랜을 사용할 때 사설IP를 사용하고 있으며,  
덕분에 우리는 인터넷을 사용하는 기기 하나하나에 공인IP를 분배해주지 않아도 된다.  
  


## **II. NAT는 무엇인가?**
앞서 사설IP는 다른 네트워크에서의 사용이 불가능하다고 했었다.  
그럼 무선 인터넷망을 사용하는 우리는 다른 네트워크와 어떻게 통신이 가능할까?  
NAT는 Network Address Translation의 줄임말으로, 말 그대로 '네트워크 주소 변환'이다.  
우리는 이 NAT라는 기술로 사설IP를 사용하면서 다른 네트워크와 통신할 수 있게 되었다.  
  
NAT는 사설IP를 공인IP로 바꿔준다.  
단순히 전환하는 것이 아니라, 전환하면서 포트번호를 같이 매핑한다.  
이러면 나중에 요청에 대한 응답이 다른 네트워크에서 왔을 때,  
요청을 보낸 포트번호를 통해 응답을 전달 할 수 있다.  
또, 다른 네트워크에서 식별하지 못하는 사설IP를 공인IP로 바꿔줌으로써  
외부 네트워크와 통신이 가능해지는 것이다.  
  


## **III. 포트포워딩은 무엇인가?**
우리는 서버를 만들 때 보통 포트포워딩을 하게 된다.  
LAN케이블을 사용하고 있을 때는 포트포워딩이 필요 없지만,  
무선랜을 사용하고 있는 서버장은 사설IP를 사용하기 때문에,  
외부에서 요청이 들어와도 어떤 사설IP로 요청을 보내야 하는지 모른다.  
따라서 우리는 '포트포워딩'을 통해 '포트'를 공유기에 강제로 매핑해줄 것이다.  
  
원리는 이렇다.  
1. 자신이 사용하고 있는 사설IP의 포트번호를 공유기에 직접 매핑한다.  
2. 외부 네트워크에서 들어온 요청이 공인IP를 따라 들어온다.  
3. 들어온 요청을 매핑한 포트번호로 보낸다.
4. 요청을 처리하고 응답을 반환한다.

이렇게 하면 사설IP를 사용하면서도,  
외부 네트워크가 접속할 수 있는 서버를 제작할 수 있다!  
  

## **IV. NAT와 포트포워딩의 차이점은 무엇인가?**
사실 차이라기보다, NAT라는 바운더리 내에 포트포워딩이 속하는 것이다.  
NAT는 정보가 나갈 때 포트번호를 '기억'하는 기술이라고 하면,  
포트포워딩은 공인IP에 포트번호를 강제로 매핑해두고,  
요청을 보낼 때 포트번호를 지정해 보내면 알아서 요청이  
포트번호를 타고 갈 수 있도록 하는 것이다. 

그러니까, NAT와 포트포워딩을 헷갈리지 말자.